{{ extend 'layout.html' }}
<script type="text/javascript" src="/static/prisoner/jquery.tooltip.min.js"></script>
<script type="text/javascript" src="/static/prisoner/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/static/prisoner/jquery.tooltip.min.js"></script>
<link rel="stylesheet" href="/static/prisoner/css/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="/static/prisoner/jquery.fancybox.pack.js?v=2.1.5"></script>
<link rel="stylesheet" href="/static/prisoner/css/training.css" type="text/css" media="screen"/>
<script type="text/javascript" src="/static/prisoner/stats-box.js"></script>

{{ bonus_time = 60 }}
<!-- PHOTOS DOWNLOADED FROM OPENPHOTO.NET --> 
<div id="shadow" style="display: none; min-height: 2800px;">
 <h2>Training Guidelines for Image Tagging</h2>
 <p>
	When you tag a photo, you assign it a keyword or phrase for simplified searching and classification. 
    <div style="width: 45%; float: left;  max-width: 350px; margin: 0 10px;" class="column1">  
    <img src="/static/genova/chess.jpg" width="275" height="200" border="0">
    <p><em>This photo belongs into the sports category and could be tagged with "chess" to describe the 
	the sport and other tags to describe the context ("chessboard", "check") or the objects ("king").</em></p><br>
    <img src="/static/genova/autumn.jpg" width="275" height="200" border="0">
    <p><em>This photo could be seen as an architectural photography and described with a tag "bank" or
	as a landscape photography and described as "park". Further tags can describe the context
	of the landscape, e. g. "autumn" to describe the time period.</em></p><br>
    <img src="/static/genova/pollination.jpg" width="275" height="200">
    <p><em>This photo belongs into the macro photography category and could be tagged with "bee" or "flower"
	to describe the object but can be also seen as an action photography and described with
	"pollination" tag.</em></p><br><br>
    <img src="/static/genova/russian_train.jpg" width="275" height="200">
    <p><em>This photo belongs into the architectural category and can be tagged with "railway", 
	"public" or "train".
    </em>
    </p><br>
    <img src="/static/genova/control/1.jpg" width="275" heigh="200">
    <p>
      <em>
	This photo is from the travel category and can be described with tags determining a specific
	object "Eiffel tower", location (Paris, France, Europe) or with "public", "landmark" etc.
      </em>
    </p><br>
    <img src="/static/genova/control/venice.jpg" width="275" height="200">
    <p>
      <em>
	The following is a mask used in the Venice during the traditional Carnival. This puts 
	it into the fashion category and could be tagged "Venice", "mask", "carnival" or
	"historical".
      </em>
    </p><br>
    </div>  
    <div style="width: 45%; float: left; max-width: 350px; margin: 0 10px;" class="column2">
    <ul>
      <li>If a photo is in a stockpile of millions of other photos it is important to 
	add tags that describe it well. One way is to determine which type of photography
	are we dealing with and choosing tags appropriately. No list of photography types
	can be exhaustive but here are the most important types:
<!-- editorial comment, it is difficult to determine whether certain tags describe 
	foreground or background (are people in the foreground or background without a photo?)
      <li><strong>Forefront</strong> tags - Some photos have main actors in the forefront of the
	image (e. g. the bear in the photo on the left). Tags can identify this aspect of the
	image.
-->
<!--
      <li><strong>Background</strong> (scenery) tags - Tags can describe the background of the image.
	Is there landscape? Is it a picture of a city? Is there sea or mountains?
-->
      <li><strong>Landscape </strong> photography - One category of photos are landscape photos: mountains,
	sea, natural sceneries etc. If one is dealing with a landscape image the appropriate tags
	would describe the elements of the landscape (mountains, meadows, sky, sea).
      <li><strong>Wildlife </strong> photography - The genre of photography that focuses on animals and 
        their natural habitat is called wildlife photography. Animal behaviors in wild are also 
	capture by wildlife photographer. Mostly these pictures are captured to be printed in 
	journals or exhibitions. Appropriate tags would describe which animals, plants or 
	natural environments (marshes) are featured in the image.
      <li><strong>Sports </strong> photography - This genre of photography specializes in capturing 
	a decisive moment in an event of sports. Sports photography is one of the difficult types 
	of photography. It requires practice along with the various equipments. Appropriate tags
	would be the kind of sport featured (soccer), what kind of competition (World Cup, Major
	League Soccer, Olympics), teams (Sounders, USA), players (Messi), situations (penalty,
	save) etc.
      <li><strong>Architectural </strong> photography - This type of photography deals with taking 
	shots of structures, houses and buildings from different angles. The main purpose of 
	architectural photography is to create a positive impact on potential real estate buyers.
        Tags can describe what kind of building (government, corporate, public), purpose (headquarters,
	grocery store, House of Representative), name (Empire State building, Statue of Liberty)
	or neighborhood (China Town).
      <li><strong>Macro </strong> photography - Macro photography is that type of photography in 
	which pictures are shot at a closer range to showcase the details of the subject matter. 
	The interesting subjects of macro photography are flowers, insects, textures of interwoven 
	things such as sweaters, baskets etc. Words that lend themselves naturally as tags are 
	those that describe the details and context of the photography (flower or insects?, which 
	flower?). 
      <li><strong>Action </strong> photography - The world around us is in motion. Some things move slowly, 
	like growing plants or turtles. Other things move much more quickly. From birds to cars to 
	children to ocean waves, things around us move. As photography is a still medium we have to 
	seek creative ways of capturing and conveying this motion to our viewers. This quest of capturing 
	and conveying motion is collectively called action photography. Tags can describe what kind 
	of action is involved (war, natural disaster, protests etc), actors involved (unions,
	soldiers) or the context (Syria, Katrina).
      <li><strong>Astrophotography </strong> - Astrophotography is a specialized type of photography that entails 
	recording images of astronomical objects and large areas of the night sky. The first photograph of an 
	astronomical object (the Moon) was taken in 1840, but it was not until the late 19th century 
	that advances in technology allowed for detailed stellar photography. Besides being able to record 
	the details of extended objects such as the Moon, Sun, and planets, astrophotography has the ability 
	to image objects invisible to the human eye such as dim stars, nebulae, and galaxies. Appropriate
	tags describe the details (Moon, Sun, galaxy, nebula etc). 
      <li><strong>Fashion</strong> - If a photography is a fashion photography then what people
	wear on the picture is rather more important than the people themselves. It follows that
	tags can describe the apparel rather than the person featuring it.
      <li><strong>Travel</strong> - If a photography is a travel photography then tags would optimally
	describe which country or city the image seems to describe, whether the context
	is natural heritage, historical architecture, modern landmark etc.
      <li><strong>Paparazzi</strong> - Images of famous people taken by photo journalists. Tags
	could provide details on who is the star being photographed, what is her job, what
	particular activities she is famous for etc.
    </ul>
   </div>
    <div {{ = "class=bonus" if training else "" }}>
    <button class="leave_training" style="margin-left: 35%; padding-left: 10px; padding-right: 10px; padding: 5px; margin-right: 35%;">Go Back to the Task</button>
    </div> 
    
                  <br><br><br>
    <div {{ = "class=bonus" if not training else "" }}>
    <h2>Testing Your Understanding of the Guidelines</h2>
    <div class="quiz">
    <form>
    <p>
	Look at the image tags below and write down (in the text field to the right of the tag) which photo category do they describe. To review
	the categories see the Training Guidelines.
    </p>
    <div>
      <div style="float: left; min-width: 200px;">
        <ul>
          <li>eagle
          <li>Haute couture
          <li>black hole
          <li>Princess Diana
          <li>Mt. Rainier
        </ul>
      </div>
      <div style="float: left;">
        <ul style="list-style-type: none;">
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="category1" {{ = "value=wildlife" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="category2" {{ = "value=fashion" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="category3" {{ = "value=astrophotography" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="category4" {{ = "value=paparazzi" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="category5" {{ = "value=landscape" if not training else "" }}>
        </ul>
      </div>
</div>
        <p style="clear: both;">
	Look at the image tags below and write down which category do they belong to. Use only lowercase letters. To review
	the categories see the Training Guidelines.
    </p>
    <div>
      <div style="float: left; min-width: 200px">
        <ul>
          <li>score</li>
          <li>Golden Gate Bridge</li>
          <li>bugs</li>
          <li>Tadj Mahal</li>
          <li>zebra</li>
        </ul>
      </div>
      <div style="float: left;">
        <ul style="list-style-type: none;">
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=sports" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=architectural" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=macro" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=travel" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=wildlife" if not training else "" }}>
        </ul>
      </div>
</div>
<p style="clear: both;">
	Look at the image tags below and write down which category do they belong to. Use only lowercase letters. To review
	the categories see the Training Guidelines.
    </p>
    <div>
      <div style="float: left; min-width: 200px;">
        <ul>
          <li>model</li>
          <li>Earth</li>
          <li>python</li>
          <li>pier</li>
          <li>Seahawks</li>
        </ul>
      </div>
      <div style="float: left;">
        <ul style="list-style-type: none;">
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=fashion" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=astrophotography" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=wildlife" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=fashion" if not training else "" }}>
          <li><input style="position: relative; left: 25px;" type="text" id="par1" name="article1" {{ = "value=sports" if not training else "" }}>
        </ul>
      </div>
</div>
    </div>   
    <input id="quiz_given" type="hidden" {{= "value=1" if training else "value=0" }}>
<div style="clear: both;">
    <button id="butt" style="margin-left: 180px; padding: 5px; padding-left: 20px; padding-right: 20px;">Submit Answers</button>
    <button class="cancel_training" style="padding: 5px; padding-left: 30px; padding-right: 30px; margin-left: 80px;">Cancel</button>
</div>
    </form>
    </div>
    </div>
</div>
<div class="congrats">
<h1>Congratulations!</h1>
<p>You have successfully completed the training</p>
<button class="leave_training" style="margin-left: 70px; padding: 5px;">Go Back to the Task</button>
</div>
<h1>Image Tagging</h1>

<div style="position: absolute; left: 410px;">
  <h3 style="margin-bottom: 3px;">Payment Details</h3>
  <div class="stats">
    <div class="tab selected">
      <div class="stat">{{=request.price_string}}</div> Per HIT
        <span class="details">
		 This job pays {{=request.price_string}} per letter via
		 bonus. <br><br>You can find
		 bonus payments in <i>Your Account-&gt;Account
		 Settings-&gt;<br>-&gt;View your account balance and
		 transaction history</i>.
	 </span>
       </div>
       <div class="tab">
         <div class="stat">{{= improbability_rate }}%</div> Approved
	   <span class="details">
		 <p>Your submitted keywords must pass an evaluation. You will be
		 notified of your work's approval within {{=bonus_time}}
		 minutes.</p>
		 <p>To ensure that our clients are best served, we require you
		 to go through <a class="training" href="#training">image tagging training</a> 
		 before you can begin work on this task.</p>
           </span>
	 </div>
	<div class="tab">
	  <div class="stat">{{=work_limit}}</div> Available
	    <span class="details">
		Today you can tag {{=work_limit}} images (there are {{ = len(pics) }} per HIT
		so {{=work_limit}} images translates into {{=work_limit/len(pics) if work_limit % len(pics) == 0 else work_limit/len(pics)+1}} HITs). This will
		change tomorrow, depending upon our client's needs.
            </span>
	  </div>
          <div id="details_box"></div> 
	</div>
  </div>
</div>

<div style="max-width: 325px;" class="taskdetails">
<p>

You will be presented with a series of pictures. Provide 5 keywords most
appropriately describing the content of these pictures.
These pictures may contain disagreeable content (explicit sexual
    content, violence, racism, etc.).  
    
</p>
</div>

<form action id="response" method="POST">
{{ i = 0 }}
{{ while i < len(pics): }}
<h2>Image</h2>
<img style="max-width: 275px;" src={{ = pics[i].url }}>
<!-- FROM http://www.morguefile.com/archive -->
<h2>Submit your Keywords</h2>
<p>
<div style="position: relative;">
<div class="train_info">
<p>To ensure that our clients are best served, we require you
                 to go through <a class="training" href="#training">image tagging training</a>
                 before you can begin work on this task.</p>
</div>
<div class="key_inputs" style="position: absolute; left: 0px; top: 0px;">
{{ for j in [1, 2, 3, 4, 5]: }}
{{ id = "keyword" + str(i*5+j) }}
Keyword {{=j}}: <input disabled="disabled" type="text" id={{=id}}><br>
{{ pass }}
{{ i += 1 }}
</div>
</div>
</p>
{{ pass }}
<input id="submit" type="submit" disabled="true" style="min-width: 70px; font-size: 16px; margin: 10px 0;" />
</form>


<script>

params = {
    track: true,
    delay: 0, 
    showURL: false, 
    showBody: " - ", 
    fade: 150,
    fixPNG: true, 
    opacity: 1, 
    left: -120,
     top: 9
};
$('.bonus').tooltip(params);
delete params.left
delete params.top
$('.crime').tooltip(params);

//######## Keywords for the actual task and the behavior of the Submit button of the 
//######## actual task

    
    
$('form input:text').change(function(){
	re1 = $('input[id=keyword1]').val();
	re2 = $('input[id=keyword2]').val();
	re3 = $('input[id=keyword3]').val();
	re4 = $('input[id=keyword4]').val();
	re5 = $('input[id=keyword5]').val();

	if(re1 != '' & re2 != '' & re3 != '' & re4 != '' & re5 != '')
	{
		$("input[type=submit]").removeAttr('disabled');
	}
      });
     
function show_training() {
  scrollTo(0,0);
  jQuery('#shadow').fadeIn().find('button').click(function(e) {
    e.preventDefault();
    pattern = /[a-z-]+/g;
    myText1 = $('input[id=par1]').val().match(pattern);
    answers1 = new Array("geese", "yard", "close-up");
    pattern = /[a-z-]+/g;
    myText2 = $('input[id=par2]').val().match(pattern);
    answers2 = new Array("bottle", "blue", "spill");
    pattern = /[a-z-]+/g;
    myText3 = $('input[id=par3]').val().match(pattern);
    answers3 = new Array("meet", "woman", "rain", "sunset");
           
    misses1 = $(answers1).not(myText1).length + $(myText1).not(answers1).length;
    misses2 = $(answers2).not(myText2).length + $(myText2).not(answers2).length;
    misses3 = $(answers3).not(myText3).length + $(myText3).not(answers3).length;
    overall = misses1 + misses2 + misses3
    if($('input[id=quiz_given]').val()=='0')
    {
      overall = 0
    }
        //   overall = 0  //This is for testing purposes only
    if(overall == 0)
    {
            //$('.test').hide();
      $('form input:text').prop("disabled", false);
      $('#shadow').fadeOut();
      $('.train_info').fadeOut();
      $('.key_inputs').css('position', 'relative');
      if($('input[id=quiz_given]').val()=='1')
      {
        $('.congrats').fadeIn();
      }
      $('.trainbutton').fadeIn();
      window.scroll(0,0);
    }
  });
}

$("#par1").on("change", function() {
  var explanations = {};
  explanations["time"] = "None of these tags give any information about time.";
  explanations["quality"] = "None of these tags describe the quality of the image.";
  jQuery('#err').remove();
  jQuery('#cor').remove();
  var answers = new Array("forefront","background","technique");
  var pattern = /[a-z-]+/g;
  var matches = this.value.match(pattern);
  matches = $.grep(matches, function(v, k){
    return $.inArray(v, matches) === k;
  });
  if(matches.length!=3)
  {
    $('#par1').after('<div id="err">You have listed either too many or too little categories.</div>')
  }
  else
  {
    if(!($(answers).not(matches).length == 0 && $(matches).not(answers).length == 0))
    {
      var feasible_answers = new Array("forefront", "background", "time", "technique", "quality", "story");
      if($(matches).not(feasible_answers).length == 0)
      {
        $('#par1').after('<div id="err">One or more of your answers is incorrect! (Hint: ' + explanations[$(matches).not(answers)[0]] + ')</div>');
      }
      else
      {
        $('#par1').after('<div id="err">Only categories explained in the Training Guidelines count as a valid answer.</div>');
      }
    }
    else
    {
      $('#par1').after('<div id="cor">Well done!</div>');
    }
  }
});

$("#par2").on("change", function() {
  var explanations = {};
  explanations["time"] = "There is no tag conveying time information in the list.";
  explanations["technique"] = "None of the tags quite describes how to picture was taken or what kind of photo it is.";
  explanations["quality"] = "None of the tags tells us about resolution, colors or sharpness of the image.";
  jQuery('#err').remove();
  jQuery('#cor').remove();
  var answers = new Array("forefront","background","story");
  var pattern = /[a-z-]+/g;
  var matches = this.value.match(pattern);
  matches = $.grep(matches, function(v, k){
    return $.inArray(v, matches) === k;
  });
  if(matches.length!=3)
  {
    $('#par2').after('<div id="err">This is not the right number of categories. Either too much or too little.</div>')
  }
  else
  {
    if(!($(answers).not(matches).length == 0 && $(matches).not(answers).length == 0))
    {
      var feasible_answers = new Array("forefront", "background", "time", "technique", "quality", "story");
      if($(matches).not(feasible_answers).length == 0)
      {
        $('#par2').after('<div id="err">One or more of your answers is incorrect! (Hint: ' + explanations[$(matches).not(answers)[0]] + ')</div>');
      }
      else
      {
        $('#par2').after('<div id="err">Only categories described in the above Training Guidelines are admissible answers.</div>');
      }
    }
    else
    {
      $('#par2').after('<div id="cor">Well done!</div>');
    }
  }
});

$("#par3").on("change", function() {
  var explanations = {};
  explanations["technique"] = "Read the Training Guidelines.";
  explanations["quality"] = "Review the Training Guidelines.";
  jQuery('#err').remove();
  jQuery('#cor').remove();
  var answers = new Array("forefront","background","time", "story");
  var pattern = /[a-z-]+/g;
  var matches = this.value.match(pattern);
  matches = $.grep(matches, function(v, k){
    return $.inArray(v, matches) === k;
  });
  if(matches.length!=4)
  {
    $('#par3').after('<div id="err">You are either missing a category or have written down too many of them.</div>')
  }
  else
  {
    if(!($(answers).not(matches).length == 0 && $(matches).not(answers).length == 0))
    {
      var feasible_answers = new Array("forefront", "background", "time", "technique", "quality", "story");
      if($(matches).not(feasible_answers).length == 0)
      {
        $('#par3').after('<div id="err">One or more of your answers is incorrect! (Hint: ' + explanations[$(matches).not(answers)[0]] + ')</div>');
      }
      else
      {
        $('#par3').after('<div id="err">Only categories described in the above Training Guidelines are admissible.</div>');
      }
    }
    else
    {
      $('#par3').after('<div id="cor">Well done!</div>');
    }
  }
});

function leave_training(){
  window.scroll(0,0);
  $('#shadow').fadeOut();
}

function hide_training() {
  window.scroll(0,0);
  $('#shadow').fadeOut();
  $('.congrats').fadeOut();
}

$(".training").bind('click', show_training);
$('.leave_training').bind('click', hide_training);    
$(".cancel_training").bind('click', leave_training);


$(document).on('click', 'a.training', show_training);    
</script>
